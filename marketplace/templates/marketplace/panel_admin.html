{% extends 'marketplace/base.html' %}
{% load extras %}

{% block content %}
<div class="container" style="max-width: 1100px; margin: 40px auto; padding: 0 20px;">
    
    <h1 style="color: #003366; margin-bottom: 30px;">
        <i class="fas fa-user-shield"></i> Consola de Administración INITRE
    </h1>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 40px;">
        
        <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-bottom: 5px solid #3498db;">
            <p style="color: #7f8c8d; margin: 0; text-transform: uppercase; font-size: 0.8rem; font-weight: bold;">Volumen Total de Ventas</p>
            <h2 style="font-size: 2rem; color: #2c3e50; margin: 10px 0;">${{ total_ventas|stringformat:".2f" }}</h2>
            <span style="color: #3498db; font-size: 0.9rem;"><i class="fas fa-globe"></i> En toda la plataforma</span>
        </div>

        <div style="background: #003366; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); color: white;">
            <p style="color: #bdc3c7; margin: 0; text-transform: uppercase; font-size: 0.8rem; font-weight: bold;">Tus Ganancias (5%)</p>
            <h2 style="font-size: 2.5rem; color: #f39c12; margin: 10px 0;">${{ tus_ganancias|stringformat:".2f" }}</h2>
            <span style="color: #fff; font-size: 0.9rem;"><i class="fas fa-piggy-bank"></i> Listas para cobro</span>
        </div>

        <div style="background: white; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); border-bottom: 5px solid #27ae60;">
            <p style="color: #7f8c8d; margin: 0; text-transform: uppercase; font-size: 0.8rem; font-weight: bold;">Ventas Realizadas</p>
            <h2 style="font-size: 2rem; color: #2c3e50; margin: 10px 0;">{{ ventas.count }}</h2>
            <span style="color: #27ae60; font-size: 0.9rem;"><i class="fas fa-shopping-cart"></i> Transacciones exitosas</span>
        </div>
    </div>

    <div style="background: white; border-radius: 15px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.05);">
        <h3 style="color: #2c3e50; margin-bottom: 20px;">Historial Global de Comisiones</h3>
        <table style="width: 100%; border-collapse: collapse; text-align: left;">
            <thead>
                <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                    <th style="padding: 15px;">Fecha</th>
                    <th style="padding: 15px;">Vendedor</th>
                    <th style="padding: 15px;">Producto</th>
                    <th style="padding: 15px;">Monto Total</th>
                    <th style="padding: 15px; color: #f39c12;">Tu Comisión (5%)</th>
                </tr>
            </thead>
            <tbody>
                {% for venta in ventas %}
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 15px;">{{ venta.created_at|date:"d/m/Y" }}</td>
                    <td style="padding: 15px;">{{ venta.seller.username }}</td>
                    <td style="padding: 15px;">{{ venta.product.title|truncatechars:30 }}</td>
                    <td style="padding: 15px; font-weight: bold;">${{ venta.price }}</td>
                    <td style="padding: 15px; font-weight: bold; color: #e67e22;">+ ${{ venta.price|calcular_tu_comision|stringformat:".2f" }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}